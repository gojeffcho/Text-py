label exploit:

  $expected = ["LOOK", "L", "HELP", "?", "RUN", "EXIT"]
  $pickup = []
  
  $room = "Exploit"
  $exploit_roomlabel()
  
  $desc = "{cps=0}"
  $desc += exploit_header("Resistance Exploit")
  $desc += """{color=[crimson]}|                                                                        |
|{/color}{color=[sheepcolor]} Available Commands:                                                    {/color}{color=[crimson]}|
|{/color}    {color=[sheepcolor]}<{/color}{color=#""" + skyblue + """}run{/color}{color=[sheepcolor]}>: execute exploit                                              {/color}{color=[crimson]}|
|{/color}    {color=[sheepcolor]}<{/color}{color=#""" + skyblue + """}exit{/color}{color=[sheepcolor]}>: return to main screen                                       {/color}{color=[crimson]}| 
|________________________________________________________________________|{/color}"""
  $say()
  
  while True:
    $echo()
    
    if cmd.upper() not in expected:
      python:
        eastered = False
        for word in easters:
          if cmd == word or args == word or word in args:
            easter(word)
            eastered = True
        
        if not eastered:
          input_error()
      
    elif cmd.upper() == "LOOK" or cmd.upper() == "L":
      if len(args) == 0:
        $flush_input()
        nvl clear
        jump exploit
      else:
        $has_args()
            
    elif cmd.upper() == "HELP" or cmd == "?":
      $help()

    elif cmd.upper() == "EXIT":
      if len(args) == 0:
        $flush_input()
        
        term "Covering traces of exploit{nw}"
        play sound "music/distorted2.ogg"
        extend "{cps=6}... ...{/cps}{cps=130} Done.{/cps}\nDeacivating exploit.app {cps=6} \ ... ... {/cps}{nw}"
        play sound "music/beep2.ogg"
        extend "{cps=130}Done.{/cps} \nPress {b}ENTER{/b} to return to main screen."
        
        nvl clear
        jump mainscreen
        
      else:
        $has_args()
                
    elif cmd.upper() == "RUN":
      if len(args) == 0:

        # Run the exploit
        if not todayexploited:

          $flush_input()
          $todayexploited = True
          $desc = "Engaging automated encryption cracking protocol. \nPress <{b}ENTER{/b}> to initiate."
          $say()
          
          $flush_input()
          nvl clear
          
          # TODO: PLAY EXPLOIT SOUND HERE
#           play sound "music/distorted2.ogg"
          call hackgame

          python:
  
            source =  "abcdefghijklmnopqrstuvwxyz"
            source += "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
            source += "`0123456789-=~!@#$%^&*)(_+"
            source += ":,.?"
    
            limit = len(source) - 1
#             opendone = "{color=[crimson]}"
#             opennew = "{color=[sheepcolor]}"
            closecolor = "{/color}"
    
            headerText = "{cps=0}\n\n\n\n\n\n\n\n\n                         "
            headerText += "Cracking encryption..."
            headerText += "\n\n"
            curText = "                            "
            newText = ""
    
            for num in range(renpy.random.randint(10,16)):
    
              for i in range(renpy.random.randint(0,10)):
    
                newText = source[renpy.random.randint(0, limit)]
    
                nvl_clear()
                desc = headerText + "{color=[crimson]}" + curText + "{/color}" + "{color=[sheepcolor]}" + newText + "{/color}{/cps}{nw}"
                say()
      
              curText += newText
      
            renpy.play("music/distorted2.ogg")
            headerText = "{cps=0}\n\n\n\n\n\n\n\n\n                         "
            headerText += "Encryption defeated!"
            headerText += "\n\n"
    
            for i in range(5):
              nvl_clear()
              desc = headerText + "{color=[ivory]}" + curText + "{/color}{/cps}{nw}"
              say()
      
              nvl_clear()    
              desc = headerText + curText + "{/cps}{nw}"
              say()
      
            # Final static display
            nvl_clear()
            desc = headerText + "{color=[ivory]}" + curText + "{/color}{/cps}\n\n               Press <{b}ENTER{/b}> to transmit exploited data."
            say()
            
            # Play transmit sound here
            renpy.play("music/data.ogg")
            desc = "                     Transmitting{cps=4}... ... ...{/cps} Done.\n                Press <{b}ENTER{/b}> to return to exploit menu."
            say()
            
            nvl_clear()
            renpy.jump("exploit")

        else:
          $flush_input()
          $desc = "You have already executed the exploit today.  Attempting more than one exploit per day is disallowed as it exposes unnecessary risk."
          $say()

      else:
        $has_args()
    
    